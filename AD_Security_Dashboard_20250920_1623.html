<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>AD Security Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
    .container { max-width: 1400px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    h1 { text-align: center; color: #2c3e50; margin-bottom: 10px; font-size: 2.5em; }
    .subtitle { text-align: center; color: #666; margin-bottom: 40px; }
    .summary-stats { display: flex; justify-content: space-around; margin: 30px 0; text-align: center; }
    .stat-box { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; min-width: 150px; }
    .stat-number { font-size: 2em; font-weight: bold; margin-bottom: 5px; }
    .stat-label { font-size: 0.9em; opacity: 0.9; }
    .dashboard-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin: 30px 0; }
    .chart-section { background: #fafafa; padding: 20px; border-radius: 8px; border: 1px solid #e0e0e0; }
    .chart-title { font-size: 1.5em; font-weight: bold; margin-bottom: 20px; text-align: center; color: #2c3e50; }
    .chart-container { position: relative; height: 400px; margin: 20px 0; }
    table { width: 100%; margin: 20px 0; border-collapse: collapse; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    th, td { border: 1px solid #ddd; padding: 12px; vertical-align: top; text-align: left; }
    th { background: #34495e; color: white; font-weight: bold; }
    tr:nth-child(even) { background-color: #f9f9f9; }
    .risk-badge { padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: bold; text-transform: uppercase; }
    .badge-critical { background-color: #d32f2f; color: white; }
    .badge-high { background-color: #f44336; color: white; }
    .badge-medium { background-color: #ff9800; color: white; }
    .badge-low { background-color: #4caf50; color: white; }
    .export-btn { background: #2196F3; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
    .export-btn:hover { background: #1976D2; }
    @media (max-width: 768px) { .dashboard-grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <div class="container">
    <h1>Active Directory Security Dashboard</h1>
    <p class="subtitle">Generated: 2025-09-20 16:23:43 | Domain: Homelan.lab</p>
    
    <div class="summary-stats">
      <div class="stat-box">
        <div class="stat-number">7</div>
        <div class="stat-label">Total Flagged</div>
      </div>
      <div class="stat-box">
        <div class="stat-number">4</div>
        <div class="stat-label">Privileged Users</div>
      </div>
      <div class="stat-box">
        <div class="stat-number">5</div>
        <div class="stat-label">Critical Issues</div>
      </div>
      <div class="stat-box">
        <div class="stat-number">4</div>
        <div class="stat-label">Stale Accounts</div>
      </div>
    </div>    <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 5px; padding: 20px; margin: 20px 0;">
      <h3 style="color: #856404; margin-top: 0;">🚨 Security Alerts</h3>
      <ul style="color: #856404; margin-bottom: 0;">        <li>⚠️ Stale accounts detected: 4 accounts</li>
        <li>🔴 Critical groups with members: 3 groups need review</li>
      </ul></div>
    <div class="dashboard-grid">
      <div class="chart-section">
        <div class="chart-title">Account Control Flags</div>
        <div class="chart-container">
          <canvas id="flagsChart"></canvas>
        </div>
      </div>
      <div class="chart-section">
        <div class="chart-title">Privileged Groups</div>
        <div class="chart-container">
          <canvas id="groupsChart"></canvas>
        </div>
      </div>
    </div>
    
    <div style="text-align: center; margin: 30px 0;">
      <button class="export-btn" onclick="exportFlagsCSV()">Export Flags CSV</button>
      <button class="export-btn" onclick="exportGroupsCSV()">Export Groups CSV</button>
      <button class="export-btn" onclick="window.print()">Print Report</button>
    </div>
    
    <h2 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px;">Account Control Flags</h2>
    <table>
      <tr><th>Flag</th><th>Risk</th><th>Description</th><th>Count</th><th>Sample Accounts</th></tr>      <tr>
        <td><strong>DONT_REQ_PREAUTH</strong></td>
        <td><span class="risk-badge badge-high">High</span></td>
        <td>No Kerberos PreAuth required</td>
        <td style="text-align:right"><strong>1</strong></td>
        <td>cmunn</td>
      </tr>      <tr>
        <td><strong>DontExpirePassword</strong></td>
        <td><span class="risk-badge badge-medium">Medium</span></td>
        <td>Password never expires</td>
        <td style="text-align:right"><strong>3</strong></td>
        <td>Guest, Administrator, cmunn</td>
      </tr>      <tr>
        <td><strong>AccountDisabled</strong></td>
        <td><span class="risk-badge badge-low">Low</span></td>
        <td>Disabled accounts</td>
        <td style="text-align:right"><strong>2</strong></td>
        <td>Guest, krbtgt</td>
      </tr>      <tr>
        <td><strong>PasswordCantChange</strong></td>
        <td><span class="risk-badge badge-medium">Medium</span></td>
        <td>Password cannot change</td>
        <td style="text-align:right"><strong>0</strong></td>
        <td>(none)</td>
      </tr>      <tr>
        <td><strong>Lockout</strong></td>
        <td><span class="risk-badge badge-medium">Medium</span></td>
        <td>Locked-out accounts</td>
        <td style="text-align:right"><strong>0</strong></td>
        <td>(none)</td>
      </tr>      <tr>
        <td><strong>UseDesKey</strong></td>
        <td><span class="risk-badge badge-high">High</span></td>
        <td>Use DES encryption (weak)</td>
        <td style="text-align:right"><strong>0</strong></td>
        <td>(none)</td>
      </tr>      <tr>
        <td><strong>PasswordNotRequired</strong></td>
        <td><span class="risk-badge badge-high">High</span></td>
        <td>Password not required</td>
        <td style="text-align:right"><strong>1</strong></td>
        <td>Guest</td>
      </tr>      <tr>
        <td><strong>TrustedForDelegation</strong></td>
        <td><span class="risk-badge badge-high">High</span></td>
        <td>Trusted for delegation</td>
        <td style="text-align:right"><strong>0</strong></td>
        <td>(none)</td>
      </tr>    </table>
    
    <h2 style="color: #2c3e50; border-bottom: 2px solid #e74c3c; padding-bottom: 10px;">Privileged Groups</h2>
    <table>
      <tr><th>Group</th><th>Risk</th><th>Description</th><th>Enabled</th><th>Disabled</th><th>Sample Members</th></tr>      <tr>
        <td><strong>Account Operators</strong></td>
        <td><span class="risk-badge badge-high">High</span></td>
        <td>User/Group management</td>
        <td style="text-align:right"><strong>0</strong></td>
        <td style="text-align:right">0</td>
        <td>(none)</td>
      </tr>      <tr>
        <td><strong>Enterprise Admins</strong></td>
        <td><span class="risk-badge badge-critical">Critical</span></td>
        <td>Full forest control</td>
        <td style="text-align:right"><strong>1</strong></td>
        <td style="text-align:right">0</td>
        <td>Administrator</td>
      </tr>      <tr>
        <td><strong>Schema Admins</strong></td>
        <td><span class="risk-badge badge-critical">Critical</span></td>
        <td>Schema modification rights</td>
        <td style="text-align:right"><strong>1</strong></td>
        <td style="text-align:right">0</td>
        <td>Administrator</td>
      </tr>      <tr>
        <td><strong>Domain Admins</strong></td>
        <td><span class="risk-badge badge-critical">Critical</span></td>
        <td>Full domain control</td>
        <td style="text-align:right"><strong>1</strong></td>
        <td style="text-align:right">0</td>
        <td>Administrator</td>
      </tr>      <tr>
        <td><strong>Server Operators</strong></td>
        <td><span class="risk-badge badge-high">High</span></td>
        <td>Server management</td>
        <td style="text-align:right"><strong>0</strong></td>
        <td style="text-align:right">0</td>
        <td>(none)</td>
      </tr>      <tr>
        <td><strong>Administrators</strong></td>
        <td><span class="risk-badge badge-high">High</span></td>
        <td>Local admin rights</td>
        <td style="text-align:right"><strong>1</strong></td>
        <td style="text-align:right">0</td>
        <td>Administrator</td>
      </tr>      <tr>
        <td><strong>DNSAdmins</strong></td>
        <td><span class="risk-badge badge-high">High</span></td>
        <td>DNS management</td>
        <td style="text-align:right"><strong>0</strong></td>
        <td style="text-align:right">0</td>
        <td>(none)</td>
      </tr>      <tr>
        <td><strong>Backup Operators</strong></td>
        <td><span class="risk-badge badge-high">High</span></td>
        <td>Backup/Restore privileges</td>
        <td style="text-align:right"><strong>0</strong></td>
        <td style="text-align:right">0</td>
        <td>(none)</td>
      </tr>      <tr>
        <td><strong>Print Operators</strong></td>
        <td><span class="risk-badge badge-medium">Medium</span></td>
        <td>Printer management</td>
        <td style="text-align:right"><strong>0</strong></td>
        <td style="text-align:right">0</td>
        <td>(none)</td>
      </tr></table>    <h2 style="color: #2c3e50; border-bottom: 2px solid #f39c12; padding-bottom: 10px;">⚠️ Stale Accounts (Top 20)</h2>
    <table>
      <tr><th>Account</th><th>Last Logon</th><th>Password Set</th><th>Days Inactive</th></tr>      <tr>
        <td>jdoe</td>
        <td>Never</td>
        <td>Unknown</td>
        <td>Never</td>
      </tr>      <tr>
        <td>jsmith</td>
        <td>Never</td>
        <td>Unknown</td>
        <td>Never</td>
      </tr>      <tr>
        <td>lmunn</td>
        <td>Never</td>
        <td>Unknown</td>
        <td>Never</td>
      </tr>      <tr>
        <td>hrodriguez</td>
        <td>Never</td>
        <td>Unknown</td>
        <td>Never</td>
      </tr></table>  </div>
  <script>
    window.addEventListener('load', function() {
      // Flags chart data
      var flagsLabels = [        'DONT_REQ_PREAUTH',
        'DontExpirePassword',
        'AccountDisabled',
        'PasswordCantChange',
        'Lockout',
        'UseDesKey',
        'PasswordNotRequired',
        'TrustedForDelegation',
      ];
      var flagsCounts = [1,3,2,0,0,0,1,0,];
      var flagsColors = ['#f44336','#ff9800','#4caf50','#ff9800','#ff9800','#f44336','#f44336','#f44336',      ];

      // Groups chart data
      var groupsLabels = [        'Account Operators',
        'Enterprise Admins',
        'Schema Admins',
        'Domain Admins',
        'Server Operators',
        'Administrators',
        'DNSAdmins',
        'Backup Operators',
        'Print Operators',
      ];
      var groupsCounts = [0,1,1,1,0,1,0,0,0,];
      var groupsColors = ['#f44336','#d32f2f','#d32f2f','#d32f2f','#f44336','#f44336','#f44336','#f44336','#ff9800',      ];

      // Create charts
      try {
        var flagsCtx = document.getElementById('flagsChart');
        new Chart(flagsCtx, {
          type: 'bar',
          data: {
            labels: flagsLabels,
            datasets: [{
              data: flagsCounts,
              backgroundColor: flagsColors.map(c => c + '80'),
              borderColor: flagsColors,
              borderWidth: 2
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: { 
              y: { 
                beginAtZero: true,
                ticks: {
                  stepSize: 1,
                  callback: function(value) {
                    if (Number.isInteger(value)) {
                      return value;
                    }
                  }
                }
              } 
            }
          }
        });

        var groupsCtx = document.getElementById('groupsChart');
        new Chart(groupsCtx, {
          type: 'bar',
          data: {
            labels: groupsLabels,
            datasets: [{
              data: groupsCounts,
              backgroundColor: groupsColors.map(c => c + '80'),
              borderColor: groupsColors,
              borderWidth: 2
            }]
          },
          options: {
            indexAxis: 'y',
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: { 
              x: { 
                beginAtZero: true,
                ticks: {
                  stepSize: 1,
                  callback: function(value) {
                    if (Number.isInteger(value)) {
                      return value;
                    }
                  }
                }
              } 
            }
          }
        });
      } catch (e) {
        console.error('Chart error:', e);
      }
    });

    function exportFlagsCSV() {
      var csv = 'Flag,Risk,Description,Count\\n';
      for (var i = 0; i < flagsLabels.length; i++) {
        csv += flagsLabels[i] + ',' + flagsColors[i] + ',Flag ' + i + ',' + flagsCounts[i] + '\\n';
      }
      downloadCSV(csv, 'AD_Flags.csv');
    }

    function exportGroupsCSV() {
      var csv = 'Group,Risk,Members\\n';
      for (var i = 0; i < groupsLabels.length; i++) {
        csv += groupsLabels[i] + ',' + groupsColors[i] + ',' + groupsCounts[i] + '\\n';
      }
      downloadCSV(csv, 'AD_Groups.csv');
    }

    function downloadCSV(csv, filename) {
      var blob = new Blob([csv], {type: 'text/csv'});
      var url = URL.createObjectURL(blob);
      var a = document.createElement('a');
      a.href = url;
      a.download = filename;
      a.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
